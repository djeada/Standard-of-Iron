{
  "id": "battle_of_zama",
  "title": "Battle of Zama",
  "summary": "The final confrontation - face Scipio Africanus in Africa. Rome's greatest general has learned your tactics and prepares the perfect counter",
  "teaching_goal": "Adapting to an opponent who knows your tactics. Tests all skills learned - the ultimate challenge against a master tactician.",
  "narrative_intent": "The culmination of the campaign. Whether victory or defeat, this battle determines the fate of Carthage and Rome.",
  "map_path": ":/assets/maps/map_battle_zama.json",
  "player_setup": {
    "nation": "carthage",
    "faction": "carthaginian",
    "color": "blue",
    "starting_units": [
      {
        "type": "spearman",
        "count": 22,
        "position": {"x": 60, "z": 60}
      },
      {
        "type": "swordsman",
        "count": 18,
        "position": {"x": 62, "z": 58}
      },
      {
        "type": "horse_swordsman",
        "count": 10,
        "position": {"x": 58, "z": 62}
      },
      {
        "type": "archer",
        "count": 12,
        "position": {"x": 60, "z": 56}
      },
      {
        "type": "elephant",
        "count": 8,
        "position": {"x": 56, "z": 60}
      }
    ],
    "starting_buildings": [],
    "starting_resources": {
      "gold": 500,
      "food": 400
    }
  },
  "ai_setups": [
    {
      "id": "roman_scipio_army",
      "nation": "roman_republic",
      "faction": "roman",
      "color": "red",
      "difficulty": "legendary",
      "personality": {
        "aggression": 0.8,
        "defense": 0.7,
        "harassment": 0.5
      },
      "starting_units": [
        {
          "type": "spearman",
          "count": 30,
          "position": {"x": 160, "z": 60}
        },
        {
          "type": "swordsman",
          "count": 25,
          "position": {"x": 162, "z": 58}
        },
        {
          "type": "horse_swordsman",
          "count": 15,
          "position": {"x": 155, "z": 62}
        },
        {
          "type": "archer",
          "count": 15,
          "position": {"x": 160, "z": 56}
        }
      ],
      "starting_buildings": [
        {
          "type": "barracks",
          "position": {"x": 170, "z": 60},
          "max_population": 220
        }
      ],
      "ai_behavior_phases": [
        {
          "phase": "anti_elephant_formation",
          "behavior": "create_lanes_for_elephants",
          "duration": 120.0
        },
        {
          "phase": "counter_envelopment",
          "behavior": "cavalry_superiority_flanking",
          "trigger": "elephants_neutralized"
        },
        {
          "phase": "final_push",
          "behavior": "coordinated_assault",
          "trigger": "enemy_weakened"
        }
      ]
    }
  ],
  "victory_conditions": [
    {
      "type": "destroy_all_enemies",
      "description": "Defeat Scipio's army and secure Carthage's future"
    }
  ],
  "defeat_conditions": [
    {
      "type": "lose_all_units",
      "description": "Do not lose all your units"
    }
  ],
  "optional_objectives": [
    {
      "type": "elephant_effectiveness",
      "description": "Use elephants effectively before they panic"
    },
    {
      "type": "overcome_cavalry_disadvantage",
      "description": "Win despite inferior cavalry"
    }
  ],
  "events": [
    {
      "trigger": {
        "type": "timer",
        "time": 30.0
      },
      "actions": [
        {
          "type": "show_message",
          "text": "Scipio has studied your tactics. He opens his lines to let your elephants pass harmlessly!"
        }
      ]
    },
    {
      "trigger": {
        "type": "custom",
        "condition": "elephants_panic"
      },
      "actions": [
        {
          "type": "show_message",
          "text": "The elephants panic! Your own beasts turn against you!"
        }
      ]
    },
    {
      "trigger": {
        "type": "custom",
        "condition": "cavalry_flanking"
      },
      "actions": [
        {
          "type": "show_message",
          "text": "Scipio's cavalry - your own former Numidian allies - sweep around your flanks!"
        }
      ]
    },
    {
      "trigger": {
        "type": "custom",
        "condition": "final_phase"
      },
      "actions": [
        {
          "type": "show_message",
          "text": "This is it - the moment that will decide the fate of Carthage and Rome!"
        }
      ]
    }
  ]
}
